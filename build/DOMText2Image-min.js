"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var DOMText2Image=function(){function t(){_classCallCheck(this,t),this.element=document.createElement("div"),this.cnv=document.createElement("canvas"),this.ctx=this.cnv.getContext("2d"),this.scale=window.devicePixelRatio}return _createClass(t,[{key:"convertText",value:function(t){var e=window.getComputedStyle(t);document.body.appendChild(this.element),this.element.innerHTML=t.innerHTML,this.element.style.position="fixed",this.element.style.left="0px",this.element.style.top="0px",this.element.style.width=e.width,this.element.style.fontFamily=e.fontFamily,this.element.style.fontSize=e.fontSize,this.element.style.textAlign=e.textAlign,this.element.style.visibility="hidden",this.extractedProperties=[],this.extractNodeProperties(this.element,this.extractedProperties),this.modifyExtractedProperties();var n=this.prepareCanvas();return document.body.removeChild(this.element),n}},{key:"extractNodeProperties",value:function(t,e){for(var n,i=t.childNodes,o=0;o<i.length;o++){i[o].nodeType===Node.TEXT_NODE?(n=window.getComputedStyle(t),e.push({fontFamily:n.getPropertyValue("font-family"),fontSize:n.getPropertyValue("font-size"),fontWeight:n.getPropertyValue("font-weight"),fontStyle:n.getPropertyValue("font-style"),color:n.getPropertyValue("color"),text:i[o].textContent})):this.extractNodeProperties(i[o],e)}}},{key:"modifyExtractedProperties",value:function(){var o="";this.extractedProperties.forEach(function(t,e){var n='<span style="font-family:'.concat(t.fontFamily,"; font-size:").concat(t.fontSize,"; font-weight:").concat(t.fontWeight,"; font-style:").concat(t.fontStyle,"; color:").concat(t.color,';">'),i=t.text.split(" ").join("</span> ".concat(n));t.text="".concat(n).concat(t.text,"</span>"),o="".concat(o).concat(n).concat(i,"</span>")}),this.element.innerHTML=o}},{key:"prepareCanvas",value:function(){var t=this.element.offsetWidth,e=this.element.offsetHeight;this.cnv.width=t*this.scale,this.cnv.height=e*this.scale,this.ctx.clearRect(0,0,this.cnv.width,this.cnv.height),this.ctx.save(),this.ctx.scale(this.scale,this.scale);for(var n=this.element.getElementsByTagName("span"),i=0;i<n.length;i++){var o=window.getComputedStyle(n[i]);parseFloat(o.fontSize);this.ctx.fillStyle=o.color,this.ctx.font="".concat(o.fontStyle," ").concat(o.fontWeight," ").concat(o.fontSize," ").concat(o.fontFamily),this.ctx.textBaseline="bottom",this.ctx.fillText(n[i].textContent,n[i].offsetLeft,n[i].offsetTop+n[i].offsetHeight)}return this.ctx.restore(),{img:this.cnv.toDataURL(),width:t,height:e}}}]),t}();